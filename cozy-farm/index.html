<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Cozy Farm Pricing Calculator</title>

<link rel="manifest" href="manifest.json">
<link rel="icon" href="icons/icon-192.png" sizes="192x192" type="image/png">
<link rel="icon" href="icons/icon-512.png" sizes="512x512" type="image/png">
<meta name="theme-color" content="#6fbf73">

<style>
 @font-face {
  font-family: 'VT323';
  src: url('fonts/VT323-Regular.ttf') format('truetype');
  font-weight: normal;
  font-style: normal;
}

@font-face {
  font-family: 'Press Start 2P';
  src: url('fonts/PressStart2P-Regular.ttf') format('truetype');
  font-weight: normal;
  font-style: normal;
}
* {
  font-family: 'VT323', monospace;
}
:root{
  --panel:#f7ecd1;
  --border:#6b3f1d;
  --wood:#a97142;
  --wood-dark:#4a2a12;
  --text:#3b2f2f;
}
*{box-sizing:border-box;}
body{
  margin:0;
  font-family: 'VT323', monospace;
  padding:20px;

  background:
    linear-gradient(rgba(0,0,0,0.25), rgba(0,0,0,0.35)),
    url("bg.jpg");

  background-size: cover;
  background-position: center;
  background-repeat: no-repeat;
  background-attachment: fixed;
}

.container{
  max-width:1100px;
  margin:auto;
  background:
    linear-gradient(rgba(247,236,209,.96), rgba(247,236,209,.96)),
    url("wood.jpg");
  border:6px solid var(--border);
  padding:20px;
  box-shadow:10px 10px 0 var(--wood-dark);
}
h1{text-align:center;font-size:44px;}
button{
  font-family:'VT323', monospace;
  font-size:22px;
  padding:10px 16px;
  background:linear-gradient(#c98b52,#a97142);
  border:4px solid var(--border);
  color:white;
  cursor:pointer;
}
button.active{background:linear-gradient(#6fbf73,#4fa85b);}
.hidden{display:none;}
input,select{
  width:100%;
  padding:6px;
  font-size:20px;
  font-family:'VT323', monospace;
  border:3px solid var(--border);
}
table{
  width:100%;
  border-collapse:collapse;
  margin-top:10px;
}
th,td{
  border:3px solid var(--border);
  padding:6px;
  text-align:center;
}
.summary{
  margin-top:20px;
  background:#fffaf0;
  border:4px solid var(--border);
  padding:14px;
  font-size:24px;
}
h1, h3 {
  font-family: 'Press Start 2P', monospace;
  text-shadow: 2px 2px rgba(0,0,0,0.4);
}

button {
  font-family: 'Press Start 2P', monospace;
  font-size: 22px;
  padding: 10px 16px;
  cursor: pointer;
}

table, th, td, input, select {
  font-family: 'VT323', monospace;
  font-size: 20px;
}
/* ===== Responsive Scaling ===== */
.scale-wrap {
  transform-origin: top center;
  transition: transform 0.2s ease;
  display: flex;
  justify-content: center;
}

@media (max-width: 768px) {
  .container {
    padding: 12px;
  }

  h1 {
    font-size: 28px;
  }

  button {
    font-size: 14px;
  }
}
</style>
</head>

<body>

<div class="scale-wrap">
  <div class="container">
    <button id="musicBtn">üéµ Music: OFF</button>
    <audio id="bgm" loop>
      <source src="bgm.mp3" type="audio/mpeg">
    </audio>

    <h1>üåæ Cozy Farm Pricing Calculator</h1>

    <button id="singleBtn">üß∫ Single</button>
    <button id="batchBtn">üì¶ Batch</button>

    <div id="batchSection" class="hidden">
      <input type="number" id="batchQty" placeholder="Batch quantity">
    </div>

    <h3>üå± Ingredients</h3>
    <table>
      <thead>
        <tr><th>Item</th><th>Qty</th><th>Unit</th><th>Cost</th></tr>
      </thead>
      <tbody id="ingredientTable"></tbody>
    </table>
    <button id="addIngredient">‚ûï Add Ingredient</button>

    <h3>üß∫ Extra Costs</h3>
    <table>
      <thead>
        <tr><th>Description</th><th>Amount</th><th>Cost</th></tr>
      </thead>
      <tbody id="additionalCostTable"></tbody>
    </table>
    <button id="addCost">‚ûï Add Cost</button>

    <div class="summary">
      <p>üå± Ingredients Total: ‚Ç± <span id="ingTotal">0.00</span></p>
      <p>üß∫ Additional Costs Total: ‚Ç± <span id="addTotal">0.00</span></p>
    </div>

    <h3>‚≠ê Profit (%)</h3>
    <input type="number" id="profit">

    <div id="singleSummary" class="summary">
      <p>Total Cost: ‚Ç± <span id="sTotal">0.00</span></p>
      <p>Selling Price: ‚Ç± <span id="sSell">0.00</span></p>
    </div>

    <div id="batchSummary" class="summary hidden">
      <p>Total Batch Cost: ‚Ç± <span id="bTotal">0.00</span></p>
      <p>Cost per Item: ‚Ç± <span id="bPer">0.00</span></p>
      <p>Selling Price per Item: ‚Ç± <span id="bSell">0.00</span></p>
    </div>
  </div>
</div>

<script src="app.js"></script>
<script>
function scaleApp() {
  const baseWidth = 1200; // design width
  const minScale = 0.5;   // never shrink below 50%
  const scale = Math.max(Math.min(window.innerWidth / baseWidth, 1), minScale);
  document.querySelector(".scale-wrap").style.transform = `scale(${scale})`;
}

window.addEventListener("resize", scaleApp);
scaleApp();
</script>

<!-- ‚úÖ PWA Install Button Script -->
<script>
let deferredPrompt;

window.addEventListener('beforeinstallprompt', (e) => {
  e.preventDefault(); // stop automatic prompt
  deferredPrompt = e;
  document.getElementById('installBtn').style.display = 'block';
});

document.getElementById('installBtn').addEventListener('click', async () => {
  if (!deferredPrompt) return;
  deferredPrompt.prompt(); // show install prompt
  const choice = await deferredPrompt.userChoice;
  console.log('Install outcome:', choice.outcome); // accepted or dismissed
  deferredPrompt = null;
  document.getElementById('installBtn').style.display = 'none';
});
</script>

</body>
</html>